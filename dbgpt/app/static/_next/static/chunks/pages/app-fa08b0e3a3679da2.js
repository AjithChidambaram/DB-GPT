(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6366],{89301:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/app",function(){return n(75610)}])},98978:function(e,t,n){"use strict";var a=n(85893),l=n(25675),i=n.n(l);t.Z=function(e){let{src:t,label:n,width:l,height:s,className:c}=e;return(0,a.jsx)(i(),{className:"w-11 h-11 rounded-full mr-4 border border-gray-200 object-contain bg-white ".concat(c),width:l||44,height:s||44,src:t,alt:n||"db-icon"})}},99743:function(e,t,n){"use strict";var a=n(85893);n(67294);var l=n(36851);t.Z=e=>{let{id:t,sourceX:n,sourceY:i,targetX:s,targetY:c,sourcePosition:r,targetPosition:d,style:o={},data:u,markerEnd:h}=e,[m,p,g]=(0,l.OQ)({sourceX:n,sourceY:i,sourcePosition:r,targetX:s,targetY:c,targetPosition:d}),x=(0,l._K)();return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(l.u5,{id:t,style:o,path:m,markerEnd:h}),(0,a.jsx)("foreignObject",{width:40,height:40,x:p-20,y:g-20,className:"bg-transparent w-10 h-10 relative",requiredExtensions:"http://www.w3.org/1999/xhtml",children:(0,a.jsx)("button",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-5 h-5 rounded-full bg-stone-400 dark:bg-zinc-700 cursor-pointer text-sm",onClick:e=>{e.stopPropagation(),x.setEdges(x.getEdges().filter(e=>e.id!==t))},children:"\xd7"})})]})}},23391:function(e,t,n){"use strict";var a=n(85893);n(67294);var l=n(36851),i=n(59819),s=n(99743),c=n(67919);n(4583),t.Z=e=>{let{flowData:t,minZoom:n}=e,r=(0,c.z5)(t);return(0,a.jsx)(l.x$,{nodes:r.nodes,edges:r.edges,edgeTypes:{buttonedge:s.Z},fitView:!0,minZoom:n||.1,children:(0,a.jsx)(i.A,{color:"#aaa",gap:16})})}},75610:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return ep}});var a=n(85893),l=n(39479),i=n(85418),s=n(42075),c=n(36147),r=n(75081),d=n(79531),o=n(51009),u=n(44442),h=n(67294),m=n(67421);function p(){return(0,a.jsx)("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5649",width:"1.5em",height:"1.5em",children:(0,a.jsx)("path",{d:"M810.666667 554.666667h-256v256h-85.333334v-256H213.333333v-85.333334h256V213.333333h85.333334v256h256v85.333334z","p-id":"5650",fill:"#bfbfbf"})})}var g=n(43893),x=n(71577),w=n(27704),v=n(85813),f=n(50888),b=n(94184),_=n.n(b),y=n(87462),S=n(4942),j=n(97685),k=n(45987),$=n(21770),I=n(15105),N=["prefixCls","className","checked","defaultChecked","disabled","loadingIcon","checkedChildren","unCheckedChildren","onClick","onChange","onKeyDown"],M=h.forwardRef(function(e,t){var n,a=e.prefixCls,l=void 0===a?"rc-switch":a,i=e.className,s=e.checked,c=e.defaultChecked,r=e.disabled,d=e.loadingIcon,o=e.checkedChildren,u=e.unCheckedChildren,m=e.onClick,p=e.onChange,g=e.onKeyDown,x=(0,k.Z)(e,N),w=(0,$.Z)(!1,{value:s,defaultValue:c}),v=(0,j.Z)(w,2),f=v[0],b=v[1];function M(e,t){var n=f;return r||(b(n=e),null==p||p(n,t)),n}var C=_()(l,i,(n={},(0,S.Z)(n,"".concat(l,"-checked"),f),(0,S.Z)(n,"".concat(l,"-disabled"),r),n));return h.createElement("button",(0,y.Z)({},x,{type:"button",role:"switch","aria-checked":f,disabled:r,className:C,ref:t,onKeyDown:function(e){e.which===I.Z.LEFT?M(!1,e):e.which===I.Z.RIGHT&&M(!0,e),null==g||g(e)},onClick:function(e){var t=M(!f,e);null==m||m(t,e)}}),d,h.createElement("span",{className:"".concat(l,"-inner")},h.createElement("span",{className:"".concat(l,"-inner-checked")},o),h.createElement("span",{className:"".concat(l,"-inner-unchecked")},u)))});M.displayName="Switch";var C=n(45353),E=n(53124),P=n(98866),Z=n(98675),z=n(10274),O=n(14747),L=n(67968),T=n(45503);let H=e=>{let{componentCls:t}=e,n=`${t}-inner`;return{[t]:{[`&${t}-small`]:{minWidth:e.switchMinWidthSM,height:e.switchHeightSM,lineHeight:`${e.switchHeightSM}px`,[`${t}-inner`]:{paddingInlineStart:e.switchInnerMarginMaxSM,paddingInlineEnd:e.switchInnerMarginMinSM,[`${n}-checked`]:{marginInlineStart:`calc(-100% + ${e.switchPinSizeSM+2*e.switchPadding}px - ${2*e.switchInnerMarginMaxSM}px)`,marginInlineEnd:`calc(100% - ${e.switchPinSizeSM+2*e.switchPadding}px + ${2*e.switchInnerMarginMaxSM}px)`},[`${n}-unchecked`]:{marginTop:-e.switchHeightSM,marginInlineStart:0,marginInlineEnd:0}},[`${t}-handle`]:{width:e.switchPinSizeSM,height:e.switchPinSizeSM},[`${t}-loading-icon`]:{top:(e.switchPinSizeSM-e.switchLoadingIconSize)/2,fontSize:e.switchLoadingIconSize},[`&${t}-checked`]:{[`${t}-inner`]:{paddingInlineStart:e.switchInnerMarginMinSM,paddingInlineEnd:e.switchInnerMarginMaxSM,[`${n}-checked`]:{marginInlineStart:0,marginInlineEnd:0},[`${n}-unchecked`]:{marginInlineStart:`calc(100% - ${e.switchPinSizeSM+2*e.switchPadding}px + ${2*e.switchInnerMarginMaxSM}px)`,marginInlineEnd:`calc(-100% + ${e.switchPinSizeSM+2*e.switchPadding}px - ${2*e.switchInnerMarginMaxSM}px)`}},[`${t}-handle`]:{insetInlineStart:`calc(100% - ${e.switchPinSizeSM+e.switchPadding}px)`}},[`&:not(${t}-disabled):active`]:{[`&:not(${t}-checked) ${n}`]:{[`${n}-unchecked`]:{marginInlineStart:e.marginXXS/2,marginInlineEnd:-e.marginXXS/2}},[`&${t}-checked ${n}`]:{[`${n}-checked`]:{marginInlineStart:-e.marginXXS/2,marginInlineEnd:e.marginXXS/2}}}}}}},V=e=>{let{componentCls:t}=e;return{[t]:{[`${t}-loading-icon${e.iconCls}`]:{position:"relative",top:(e.switchPinSize-e.fontSize)/2,color:e.switchLoadingIconColor,verticalAlign:"top"},[`&${t}-checked ${t}-loading-icon`]:{color:e.switchColor}}}},A=e=>{let{componentCls:t,motion:n}=e,a=`${t}-handle`;return{[t]:{[a]:{position:"absolute",top:e.switchPadding,insetInlineStart:e.switchPadding,width:e.switchPinSize,height:e.switchPinSize,transition:`all ${e.switchDuration} ease-in-out`,"&::before":{position:"absolute",top:0,insetInlineEnd:0,bottom:0,insetInlineStart:0,backgroundColor:e.colorWhite,borderRadius:e.switchPinSize/2,boxShadow:e.switchHandleShadow,transition:`all ${e.switchDuration} ease-in-out`,content:'""'}},[`&${t}-checked ${a}`]:{insetInlineStart:`calc(100% - ${e.switchPinSize+e.switchPadding}px)`},[`&:not(${t}-disabled):active`]:n?{[`${a}::before`]:{insetInlineEnd:e.switchHandleActiveInset,insetInlineStart:0},[`&${t}-checked ${a}::before`]:{insetInlineEnd:0,insetInlineStart:e.switchHandleActiveInset}}:{}}}},D=e=>{let{componentCls:t}=e,n=`${t}-inner`;return{[t]:{[n]:{display:"block",overflow:"hidden",borderRadius:100,height:"100%",paddingInlineStart:e.switchInnerMarginMax,paddingInlineEnd:e.switchInnerMarginMin,transition:`padding-inline-start ${e.switchDuration} ease-in-out, padding-inline-end ${e.switchDuration} ease-in-out`,[`${n}-checked, ${n}-unchecked`]:{display:"block",color:e.colorTextLightSolid,fontSize:e.fontSizeSM,transition:`margin-inline-start ${e.switchDuration} ease-in-out, margin-inline-end ${e.switchDuration} ease-in-out`,pointerEvents:"none"},[`${n}-checked`]:{marginInlineStart:`calc(-100% + ${e.switchPinSize+2*e.switchPadding}px - ${2*e.switchInnerMarginMax}px)`,marginInlineEnd:`calc(100% - ${e.switchPinSize+2*e.switchPadding}px + ${2*e.switchInnerMarginMax}px)`},[`${n}-unchecked`]:{marginTop:-e.switchHeight,marginInlineStart:0,marginInlineEnd:0}},[`&${t}-checked ${n}`]:{paddingInlineStart:e.switchInnerMarginMin,paddingInlineEnd:e.switchInnerMarginMax,[`${n}-checked`]:{marginInlineStart:0,marginInlineEnd:0},[`${n}-unchecked`]:{marginInlineStart:`calc(100% - ${e.switchPinSize+2*e.switchPadding}px + ${2*e.switchInnerMarginMax}px)`,marginInlineEnd:`calc(-100% + ${e.switchPinSize+2*e.switchPadding}px - ${2*e.switchInnerMarginMax}px)`}},[`&:not(${t}-disabled):active`]:{[`&:not(${t}-checked) ${n}`]:{[`${n}-unchecked`]:{marginInlineStart:2*e.switchPadding,marginInlineEnd:-(2*e.switchPadding)}},[`&${t}-checked ${n}`]:{[`${n}-checked`]:{marginInlineStart:-(2*e.switchPadding),marginInlineEnd:2*e.switchPadding}}}}}},R=e=>{let{componentCls:t}=e;return{[t]:Object.assign(Object.assign(Object.assign(Object.assign({},(0,O.Wf)(e)),{position:"relative",display:"inline-block",boxSizing:"border-box",minWidth:e.switchMinWidth,height:e.switchHeight,lineHeight:`${e.switchHeight}px`,verticalAlign:"middle",background:e.colorTextQuaternary,border:"0",borderRadius:100,cursor:"pointer",transition:`all ${e.motionDurationMid}`,userSelect:"none",[`&:hover:not(${t}-disabled)`]:{background:e.colorTextTertiary}}),(0,O.Qy)(e)),{[`&${t}-checked`]:{background:e.switchColor,[`&:hover:not(${t}-disabled)`]:{background:e.colorPrimaryHover}},[`&${t}-loading, &${t}-disabled`]:{cursor:"not-allowed",opacity:e.switchDisabledOpacity,"*":{boxShadow:"none",cursor:"not-allowed"}},[`&${t}-rtl`]:{direction:"rtl"}})}};var W=(0,L.Z)("Switch",e=>{let t=e.fontSize*e.lineHeight,n=e.controlHeight/2,a=t-4,l=n-4,i=(0,T.TS)(e,{switchMinWidth:2*a+8,switchHeight:t,switchDuration:e.motionDurationMid,switchColor:e.colorPrimary,switchDisabledOpacity:e.opacityLoading,switchInnerMarginMin:a/2,switchInnerMarginMax:a+2+4,switchPadding:2,switchPinSize:a,switchBg:e.colorBgContainer,switchMinWidthSM:2*l+4,switchHeightSM:n,switchInnerMarginMinSM:l/2,switchInnerMarginMaxSM:l+2+4,switchPinSizeSM:l,switchHandleShadow:`0 2px 4px 0 ${new z.C("#00230b").setAlpha(.2).toRgbString()}`,switchLoadingIconSize:.75*e.fontSizeIcon,switchLoadingIconColor:`rgba(0, 0, 0, ${e.opacityLoading})`,switchHandleActiveInset:"-30%"});return[R(i),D(i),A(i),V(i),H(i)]}),X=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&0>t.indexOf(a)&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var l=0,a=Object.getOwnPropertySymbols(e);l<a.length;l++)0>t.indexOf(a[l])&&Object.prototype.propertyIsEnumerable.call(e,a[l])&&(n[a[l]]=e[a[l]]);return n};let q=h.forwardRef((e,t)=>{let{prefixCls:n,size:a,disabled:l,loading:i,className:s,rootClassName:c,style:r}=e,d=X(e,["prefixCls","size","disabled","loading","className","rootClassName","style"]),{getPrefixCls:o,direction:u,switch:m}=h.useContext(E.E_),p=h.useContext(P.Z),g=(null!=l?l:p)||i,x=o("switch",n),w=h.createElement("div",{className:`${x}-handle`},i&&h.createElement(f.Z,{className:`${x}-loading-icon`})),[v,b]=W(x),y=(0,Z.Z)(a),S=_()(null==m?void 0:m.className,{[`${x}-small`]:"small"===y,[`${x}-loading`]:i,[`${x}-rtl`]:"rtl"===u},s,c,b),j=Object.assign(Object.assign({},null==m?void 0:m.style),r);return v(h.createElement(C.Z,{component:"Switch"},h.createElement(M,Object.assign({},d,{prefixCls:x,className:S,style:j,disabled:g,ref:t,loadingIcon:w}))))});function F(e){let{resourceTypeOptions:t,updateResourcesByIndex:n,index:l,resource:i}=e,{t:s}=(0,m.$G)(),[c,r]=(0,h.useState)(i.type||(null==t?void 0:t[0].label)),[u,p]=(0,h.useState)([]),[x,f]=(0,h.useState)({name:i.name,type:i.type,value:i.value,is_dynamic:i.is_dynamic||!1}),b=async()=>{let[e,t]=await (0,g.Vx)((0,g.RX)({type:c}));t?p(null==t?void 0:t.map(e=>({label:e,value:e}))):p([])},_=e=>{r(e)},y=(e,t)=>{x[t]=e,f(x),n(x,l)},S=()=>{n(null,l)};return(0,h.useEffect)(()=>{b(),y(x.type||c,"type")},[c]),(0,h.useEffect)(()=>{var e,t;y((null===(e=u[0])||void 0===e?void 0:e.label)||i.value,"value"),f({...x,value:(null===(t=u[0])||void 0===t?void 0:t.label)||i.value})},[u]),(0,a.jsx)(v.Z,{className:"mb-3 dark:bg-[#232734] border-gray-200",title:"Resource ".concat(l+1),extra:(0,a.jsx)(w.Z,{className:"text-[#ff1b2e] !text-lg",onClick:()=>{S()}}),children:(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center  mb-6",children:[(0,a.jsxs)("div",{className:"font-bold mr-4 w-32 text-center",children:[(0,a.jsx)("span",{className:"text-[#ff4d4f] font-normal",children:"*"}),"\xa0",s("resource_name"),":"]}),(0,a.jsx)(d.default,{className:"w-1/3",required:!0,value:x.name,onInput:e=>{y(e.target.value,"name")}}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"font-bold w-32 text-center",children:s("resource_dynamic")}),(0,a.jsx)(q,{defaultChecked:i.is_dynamic||!1,style:{background:x.is_dynamic?"#1677ff":"#ccc"},onChange:e=>{y(e,"is_dynamic")}})]})]}),(0,a.jsxs)("div",{className:"flex mb-5  items-center",children:[(0,a.jsxs)("div",{className:"font-bold mr-4 w-32  text-center",children:[s("resource_type"),": "]}),(0,a.jsx)(o.default,{className:"w-1/3",options:t,value:x.type||(null==t?void 0:t[0]),onChange:e=>{y(e,"type"),_(e)}}),(0,a.jsxs)("div",{className:"font-bold w-32 text-center",children:[s("resource_value"),":"]}),(null==u?void 0:u.length)>0?(0,a.jsx)(o.default,{value:x.value,className:"flex-1",options:u,onChange:e=>{y(e,"value")}}):(0,a.jsx)(d.default,{className:"flex-1",value:x.value||i.value,onInput:e=>{y(e.target.value,"value")}})]})]})})}function K(e){var t;let{resourceTypes:n,updateDetailsByAgentKey:l,detail:i,editResources:s}=e,{t:c}=(0,m.$G)(),[r,u]=(0,h.useState)([...null!=s?s:[]]),[p,w]=(0,h.useState)({...i,resources:[]}),[v,f]=(0,h.useState)([]),[b,_]=(0,h.useState)([]),y=(e,t)=>{u(n=>{let a=[...n];return e?a.map((n,a)=>t===a?e:n):a.filter((e,n)=>t!==n)})},S=async()=>{let[e,t]=await (0,g.Vx)((0,g.Vd)());t&&f(null==t?void 0:t.map(e=>({label:e,value:e})))},j=async e=>{let[t,n]=await (0,g.Vx)((0,g.m9)(e));if(n){var a;_(null!==(a=n.map(e=>({label:e,value:e})))&&void 0!==a?a:[])}};(0,h.useEffect)(()=>{S(),j(i.llm_strategy)},[]),(0,h.useEffect)(()=>{k(r,"resources")},[r]);let k=(e,t)=>{let n={...p};n[t]=e,w(n),l(i.key,n)},$=(0,h.useMemo)(()=>null==n?void 0:n.map(e=>({label:e,value:e})),[n]);return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center mb-6 mt-6",children:[(0,a.jsx)("div",{className:"mr-2 w-16 text-center",children:"Prompt:"}),(0,a.jsx)(d.default,{required:!0,className:"mr-6 w-1/4",value:p.prompt_template,onChange:e=>{k(e.target.value,"prompt_template")}}),(0,a.jsx)("div",{className:"mr-2",children:"LLM Strategy:"}),(0,a.jsx)(o.default,{value:p.llm_strategy,options:v,className:"w-1/6 mr-6",onChange:e=>{k(e,"llm_strategy"),j(e)}}),b&&b.length>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"mr-2",children:"LLM Strategy Value:"}),(0,a.jsx)(o.default,{value:(t=p.llm_strategy_value)?t.split(","):[],className:"w-1/4",mode:"multiple",options:b,onChange:e=>{if(!e||(null==e?void 0:e.length)===0)return k(null,"llm_strategy_value"),null;let t=e.reduce((e,t,n)=>0===n?t:"".concat(e,",").concat(t),"");k(t,"llm_strategy_value")}})]})]}),(0,a.jsx)("div",{className:"mb-3 text-lg font-bold",children:c("available_resources")}),r.map((e,t)=>(0,a.jsx)(F,{resource:e,index:t,updateResourcesByIndex:y,resourceTypeOptions:$},t)),(0,a.jsx)(x.ZP,{type:"primary",className:"mt-2",size:"middle",onClick:()=>{u([...r,{name:"",type:"",introduce:"",value:"",is_dynamic:""}])},children:c("add_resource")})]})}q.__ANT_SWITCH=!0;var B=n(23391),G=n(41664),Q=n.n(G),Y=n(36609);function J(e){var t;let{onFlowsChange:n,teamContext:l}=e,[i,s]=(0,h.useState)(),[c,r]=(0,h.useState)(),[d,u]=(0,h.useState)(),m=async()=>{let[e,t]=await (0,g.Vx)((0,g.Wf)());if(t){var a;r(null==t?void 0:null===(a=t.items)||void 0===a?void 0:a.map(e=>({label:e.name,value:e.name}))),s(t.items),n(null==t?void 0:t.items[0])}};return(0,h.useEffect)(()=>{m()},[]),(0,h.useEffect)(()=>{u((null==i?void 0:i.find(e=>(null==l?void 0:l.name)===e.name))||(null==i?void 0:i[0]))},[l,i]),(0,a.jsxs)("div",{className:"w-full h-[300px]",children:[(0,a.jsx)("div",{className:"mr-24 mb-4 mt-2",children:"Flows:"}),(0,a.jsxs)("div",{className:"flex items-center mb-6",children:[(0,a.jsx)(o.default,{onChange:e=>{u(null==i?void 0:i.find(t=>e===t.name)),n(null==i?void 0:i.find(t=>e===t.name))},value:(null==d?void 0:d.name)||(null==c?void 0:null===(t=c[0])||void 0===t?void 0:t.value),className:"w-1/4",options:c}),(0,a.jsx)(Q(),{href:"/flow/canvas/",className:"ml-6",children:(0,Y.t)("edit_new_applications")}),(0,a.jsx)("div",{className:"text-gray-500 ml-16",children:null==d?void 0:d.description})]}),d&&(0,a.jsx)("div",{className:"w-full h-full border-[0.5px] border-dark-gray",children:(0,a.jsx)(B.Z,{flowData:null==d?void 0:d.flow_data})})]})}let U=[{value:"zh",label:"中文"},{value:"en",label:"英文"}];function ee(e){let{handleCancel:t,open:n,updateApps:x,type:w,app:v}=e,{t:f}=(0,m.$G)(),[b,_]=(0,h.useState)(!1),[y,S]=(0,h.useState)(),[j,k]=(0,h.useState)(),[$,I]=(0,h.useState)([]),[N,M]=(0,h.useState)([]),[C,E]=(0,h.useState)([...(null==v?void 0:v.details)||[]]),[P,Z]=(0,h.useState)(),[z,O]=(0,h.useState)(),[L,T]=(0,h.useState)(v.team_modal||"auto_plan"),[H]=l.Z.useForm(),V=async e=>{await (0,g.Vx)("add"===w?(0,g.L5)(e):(0,g.KT)(e)),await x()},A=async()=>{let e=v.details,[t,n]=await (0,g.Vx)((0,g.Q5)());(null==e?void 0:e.length)>0&&I(null==e?void 0:e.map(e=>({label:null==e?void 0:e.agent_name,children:(0,a.jsx)(K,{editResources:"edit"===w&&e.resources,detail:{key:null==e?void 0:e.agent_name,llm_strategy:null==e?void 0:e.llm_strategy,agent_name:null==e?void 0:e.agent_name,prompt_template:null==e?void 0:e.prompt_template,llm_strategy_value:null==e?void 0:e.llm_strategy_value},updateDetailsByAgentKey:X,resourceTypes:n}),key:null==e?void 0:e.agent_name})))},D=async()=>{let[e,t]=await (0,g.Vx)((0,g.lz)());if(!t)return null;let n=t.map(e=>({value:e,label:e}));k(n)},R=async()=>{let[e,t]=await (0,g.Vx)((0,g.j8)());if(!t)return null;M(t.map(e=>({label:e.name,key:e.name,onClick:()=>{q(e)},agent:e})).filter(e=>{var t,n;return v.details&&(null===(t=v.details)||void 0===t?void 0:t.length)!==0?null==v?void 0:null===(n=v.details)||void 0===n?void 0:n.every(t=>t.agent_name!==e.label):e}))},W=async()=>{let[e,t]=await (0,g.Vx)((0,g.Q5)());t&&O(t)};(0,h.useEffect)(()=>{D(),R(),W()},[]),(0,h.useEffect)(()=>{"edit"===w&&A()},[z]),(0,h.useEffect)(()=>{T(v.team_mode||"auto_plan")},[v]);let X=(e,t)=>{E(n=>n.map(n=>e===(n.agent_name||n.key)?t:n))},q=async e=>{let t=e.name,[n,l]=await (0,g.Vx)((0,g.Q5)());S(t),E(e=>[...e,{key:t,name:"",llm_strategy:"priority"}]),I(e=>[...e,{label:t,children:(0,a.jsx)(K,{detail:{key:t,llm_strategy:"default",agent_name:t,prompt_template:"",llm_strategy_value:null},updateDetailsByAgentKey:X,resourceTypes:l}),key:t}]),M(t=>t.filter(t=>t.key!==e.name))},F=e=>{let t=y,n=-1;if(!$)return null;$.forEach((t,a)=>{t.key===e&&(n=a-1)});let a=$.filter(t=>t.key!==e);a.length&&t===e&&(t=n>=0?a[n].key:a[0].key),E(t=>null==t?void 0:t.filter(t=>(t.agent_name||t.key)!==e)),I(a),S(t),M(t=>[...t,{label:e,key:e,onClick:()=>{q({name:e,describe:"",system_message:""})}}])},B=async()=>{let e=await H.validateFields();if(!e)return;_(!0);let n={...H.getFieldsValue()};if("edit"===w&&(n.app_code=v.app_code),"awel_layout"!==n.team_mode)n.details=C;else{let e={...P};delete e.flow_data,n.team_context=e}try{await V(n)}catch(e){return}_(!1),t()};return(0,a.jsx)("div",{children:(0,a.jsx)(c.default,{okText:f("Submit"),title:"edit"===w?"edit application":"add application",open:n,width:"65%",onCancel:t,onOk:B,destroyOnClose:!0,children:(0,a.jsx)(r.Z,{spinning:b,children:(0,a.jsxs)(l.Z,{form:H,preserve:!1,size:"large",className:"mt-4 max-h-[70vh] overflow-auto h-[90vh]",layout:"horizontal",labelAlign:"left",labelCol:{span:4},initialValues:{app_name:v.app_name,app_describe:v.app_describe,language:v.language||U[0].value,team_mode:v.team_mode||"auto_plan"},autoComplete:"off",onFinish:B,children:[(0,a.jsx)(l.Z.Item,{label:"App Name",name:"app_name",rules:[{required:!0,message:f("Please_input_the_name")}],children:(0,a.jsx)(d.default,{placeholder:f("Please_input_the_name")})}),(0,a.jsx)(l.Z.Item,{label:f("Description"),name:"app_describe",rules:[{required:!0,message:f("Please_input_the_description")}],children:(0,a.jsx)(d.default.TextArea,{rows:3,placeholder:f("Please_input_the_description")})}),(0,a.jsxs)("div",{className:"flex w-full",children:[(0,a.jsx)(l.Z.Item,{labelCol:{span:7},label:f("language"),name:"language",className:"w-1/2",rules:[{required:!0}],children:(0,a.jsx)(o.default,{className:"w-2/3 ml-4",placeholder:f("language_select_tips"),options:U})}),(0,a.jsx)(l.Z.Item,{label:f("team_modal"),name:"team_mode",className:"w-1/2",labelCol:{span:6},rules:[{required:!0}],children:(0,a.jsx)(o.default,{defaultValue:v.team_mode||"auto_plan",className:"ml-4 w-72",onChange:e=>{T(e)},placeholder:f("Please_input_the_work_modal"),options:j})})]}),"awel_layout"!==L?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"mb-5",children:"Agents"}),(0,a.jsx)(u.Z,{addIcon:(0,a.jsx)(i.Z,{menu:{items:N},trigger:["click"],children:(0,a.jsx)("a",{className:"h-8 flex items-center",onClick:e=>e.preventDefault(),children:(0,a.jsx)(s.Z,{children:(0,a.jsx)(p,{})})})}),type:"editable-card",onChange:e=>{S(e)},activeKey:y,onEdit:(e,t)=>{"add"===t||F(e)},items:$})]}):(0,a.jsx)(J,{onFlowsChange:e=>{Z(e)},teamContext:v.team_context})]})})})})}var et=n(98978);function en(){return(0,a.jsx)("svg",{viewBox:"0 0 1040 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4212",width:"1.5em",height:"1.5em",children:(0,a.jsx)("path",{d:"M177.812755 934.420799l46.095851-257.966283c2.695389-15.143908-2.527566-30.567179-14.003945-41.262776L14.733563 452.469162c-28.840862-26.952862-12.94687-73.967642 26.897603-79.524195l269.74863-37.622876c15.836687-2.223644 29.509081-11.753695 36.59343-25.507954l120.647801-234.709603c17.810644-34.650171 69.270666-34.650171 87.082334 0l120.647801 234.709603c7.086395 13.754259 20.75572 23.283286 36.5658 25.507954l269.775236 37.622876c39.819914 5.556553 55.711859 52.571333 26.926256 79.524195L814.393121 635.19174c-11.44875 10.695596-16.671705 26.118867-13.978363 41.262776l46.098921 257.966283c6.807033 38.09462-34.845623 67.131957-70.465888 49.152467l-241.295602-121.81437c-14.141068-7.111978-31.035854-7.111978-45.179992 0l-241.295602 121.81437C212.655308 1001.551732 171.002652 972.514395 177.812755 934.420799L177.812755 934.420799zM534.75219 812.217572l238.684124 120.478955c11.864212 6.001691 25.75764-3.695159 23.50739-16.365736L751.34518 661.141762c-2.694365-15.115256 2.529613-30.56411 13.948687-41.289382l193.115276-180.692339c9.613962-9.003048 4.306072-24.676006-8.974395-26.5374l-266.858814-37.232996c-15.810081-2.196015-29.482475-11.727089-36.5658-25.481348L526.667048 117.729332c-5.947456-11.532661-23.090904-11.532661-29.037337 0L378.316302 349.909321c-7.086395 13.754259-20.756743 23.285333-36.566824 25.481348L74.891687 412.623665c-13.280468 1.861394-18.560728 17.534352-8.974395 26.507724l193.0856 180.720991c11.447726 10.724249 16.670681 26.174126 13.975293 41.289382l-45.569872 255.18903c-2.276856 12.670577 11.587919 22.367427 23.480784 16.365736l238.682078-120.478955C503.716336 805.074895 520.610098 805.074895 534.75219 812.217572L534.75219 812.217572zM534.75219 812.217572","p-id":"4213",fill:"#707070"})})}function ea(){return(0,a.jsx)("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4396",width:"1.5em",height:"1.5em",children:(0,a.jsx)("path",{d:"M485.173861 869.842745l-229.813553 120.819332a53.974999 53.974999 0 0 1-78.316666-56.898821l43.8912-255.899353a53.974999 53.974999 0 0 0-15.522222-47.777399L19.490266 448.857506a53.974999 53.974999 0 0 1 29.915556-92.06371l256.935108-37.338a53.974999 53.974999 0 0 0 40.639999-29.526088l114.909599-232.824864a53.974999 53.974999 0 0 1 96.802221 0l114.906776 232.824864a53.974999 53.974999 0 0 0 40.64 29.52891l256.93793 37.335178a53.974999 53.974999 0 0 1 29.915555 92.06371L815.170657 630.089326a53.974999 53.974999 0 0 0-15.522222 47.777399l43.888377 255.899353a53.974999 53.974999 0 0 1-78.316666 56.898821l-229.813552-120.819332a53.974999 53.974999 0 0 0-50.232733 0z",fill:"#f4ea2a","p-id":"4397"})})}var el=n(83062),ei=n(66309),es=n(28058),ec=n(78346),er=n(11163),ed=n(41468);let{confirm:eo}=c.default,eu={en:"英文",zh:"中文"};function eh(e){let{updateApps:t,app:n,handleEdit:l,isCollected:i}=e,{model:s}=(0,h.useContext)(ed.p),c=(0,er.useRouter)(),[r,d]=(0,h.useState)(n.is_collected),{setAgent:o}=(0,h.useContext)(ed.p),{t:u}=(0,m.$G)(),p=()=>{eo({title:u("Tips"),icon:(0,a.jsx)(es.Z,{}),content:"do you want delete the application?",okText:"Yes",okType:"danger",cancelText:"No",async onOk(){await (0,g.Vx)((0,g.Nl)({app_code:n.app_code})),t(i?{is_collected:i}:void 0)}})};(0,h.useEffect)(()=>{d(n.is_collected)},[n]);let v=async e=>{e.stopPropagation();let[a]=await (0,g.Vx)("true"===r?(0,g.gD)({app_code:n.app_code}):(0,g.mo)({app_code:n.app_code}));a||(t(i?{is_collected:i}:void 0),d("true"===r?"false":"true"))},f=async e=>{e.stopPropagation(),null==o||o(n.app_code);let[,t]=await (0,g.Vx)((0,g.sW)({chat_mode:"chat_agent"}));t&&c.push("/chat/?scene=chat_agent&id=".concat(t.conv_uid).concat(s?"&model=".concat(s):""))};return(0,a.jsxs)("div",{onClick:()=>{l(n)},className:"relative cursor-pointer mb-5 max-h-56 flex flex-shrink-0 flex-col p-4 w-72 lg:w-72 rounded  text-black bg-white shadow-[0_8px_16px_-10px_rgba(100,100,100,.08)] hover:shadow-[0_14px_20px_-10px_rgba(100,100,100,.15)] dark:bg-[#232734] dark:text-white dark:hover:border-white transition-[transfrom_shadow] duration-300 hover:-translate-y-1 ",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(et.Z,{src:"/LOGO_SMALL.png",label:"1112",className:" mr-1 inline-block mt-[-4px]"}),(0,a.jsx)("div",{className:" truncate text-sm font-semibold text-center w-32",children:null==n?void 0:n.app_name})]}),(0,a.jsx)("div",{onClick:v,children:(null==n?void 0:n.is_collected)==="false"?(0,a.jsx)(en,{}):(0,a.jsx)(ea,{})})]}),(0,a.jsxs)("div",{className:"text-sm mt-2 p-3 pt-2",children:[(0,a.jsx)(el.Z,{title:null==n?void 0:n.app_describe,children:(0,a.jsx)("div",{className:"text-sm text-gray-500 font-normal  w-52 line-clamp-2 mb-3 h-10",children:null==n?void 0:n.app_describe})}),(0,a.jsxs)("div",{className:"flex mb-3",children:[(0,a.jsx)(ei.Z,{color:"#2db7f5",className:"text-large",children:eu[null==n?void 0:n.language]}),(0,a.jsx)(ei.Z,{color:"#87d068",className:"text-large",children:null==n?void 0:n.team_mode})]})]}),(0,a.jsxs)("div",{className:"w-full flex justify-center",children:[(0,a.jsx)(x.ZP,{className:"mr-4",onClick:e=>{e.stopPropagation(),p()},icon:(0,a.jsx)(w.Z,{}),danger:!0,children:"delete"}),(0,a.jsx)(x.ZP,{size:"middle",onClick:f,className:"mr-4 dark:text-white mb-2",icon:(0,a.jsx)(ec.Z,{}),children:u("Chat")})]})]})}var em=n(32983);function ep(){let[e,t]=(0,h.useState)(!1),[n,l]=(0,h.useState)(!1),[i,s]=(0,h.useState)("app"),[c,d]=(0,h.useState)([]),[o,m]=(0,h.useState)(),[p,w]=(0,h.useState)("add"),v=()=>{w("add"),t(!0)},f=e=>{w("edit"),m(e),t(!0)},b=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};l(!0);let[t,n]=await (0,g.Vx)((0,g.yk)(e));if(t){l(!1);return}n&&(d(n||[]),l(!1))};(0,h.useEffect)(()=>{b()},[]);let _=e=>{let t=e.isCollected?c.every(e=>!e.is_collected):0===c.length;return(0,a.jsxs)("div",{className:"overflow-auto h-[800px]",children:[!e.isCollected&&(0,a.jsx)(x.ZP,{onClick:v,type:"primary",className:"mb-6",children:"+ create"}),t?(0,a.jsx)(em.Z,{}):(0,a.jsx)("div",{className:" w-full flex flex-wrap pb-0 gap-4",children:c.map((e,t)=>(0,a.jsx)(eh,{handleEdit:f,app:e,updateApps:b,isCollected:"collected"===i},t))})]})},y=[{key:"app",label:"App",children:_({isCollected:!1})},{key:"collected",label:"Collected",children:_({isCollected:!0})}];return(0,a.jsx)(r.Z,{spinning:n,children:(0,a.jsxs)("div",{className:"h-screen w-full p-4 md:p-6 overflow-y-aut",children:[(0,a.jsx)(u.Z,{defaultActiveKey:"app",items:y,onChange:e=>{s(e),"collected"===e?b({is_collected:!0}):b()}}),e&&(0,a.jsx)(ee,{app:"edit"===p?o:{},type:p,updateApps:b,open:e,handleCancel:()=>{t(!1)}})]})})}},67919:function(e,t,n){"use strict";n.d(t,{Rv:function(){return s},VZ:function(){return a},Wf:function(){return l},z5:function(){return i}});let a=(e,t)=>{let n=0;return t.forEach(t=>{t.data.name===e.name&&n++}),"".concat(e.id,"_").concat(n)},l=e=>{let{nodes:t,edges:n,...a}=e,l=t.map(e=>{let{positionAbsolute:t,...n}=e;return{position_absolute:t,...n}}),i=n.map(e=>{let{sourceHandle:t,targetHandle:n,...a}=e;return{source_handle:t,target_handle:n,...a}});return{nodes:l,edges:i,...a}},i=e=>{let{nodes:t,edges:n,...a}=e,l=t.map(e=>{let{position_absolute:t,...n}=e;return{positionAbsolute:t,...n}}),i=n.map(e=>{let{source_handle:t,target_handle:n,...a}=e;return{sourceHandle:t,targetHandle:n,...a}});return{nodes:l,edges:i,...a}},s=e=>{let{nodes:t,edges:n}=e,a=[!0,t[0],""];e:for(let e=0;e<t.length;e++){let l=t[e].data,{inputs:i=[],parameters:s=[]}=l;for(let s=0;s<i.length;s++)if(!n.some(n=>n.targetHandle==="".concat(t[e].id,"|inputs|").concat(s))){a=[!1,t[e],"The input ".concat(i[s].type_name," of node ").concat(l.label," is required")];break e}for(let i=0;i<s.length;i++){let c=s[i];if(c.optional||"resource"!==c.category||n.some(n=>n.targetHandle==="".concat(t[e].id,"|parameters|").concat(i))){if(!c.optional&&"common"===c.category&&(void 0===c.value||null===c.value)){a=[!1,t[e],"The parameter ".concat(c.type_name," of node ").concat(l.label," is required")];break e}}else{a=[!1,t[e],"The parameter ".concat(c.type_name," of node ").concat(l.label," is required")];break e}}}return a}}},function(e){e.O(0,[8241,7113,5503,1009,9479,4442,5813,7434,9924,8709,9774,2888,179],function(){return e(e.s=89301)}),_N_E=e.O()}]);